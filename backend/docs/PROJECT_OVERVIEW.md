# ğŸ“¦ Tobe Depot Management System â€” MÃ´ táº£ bÃ i toÃ¡n tá»•ng quan

## 1. Bá»‘i cáº£nh & Má»¥c tiÃªu dá»± Ã¡n
Há»‡ thá»‘ng **Tobe Depot Management System (TDMS)** lÃ  ná»n táº£ng pháº§n má»m há»— trá»£ quáº£n lÃ½ toÃ n bá»™ quy trÃ¬nh **xuáº¥t â€“ nháº­p â€“ lÆ°u trá»¯ â€“ báº£o trÃ¬ container** táº¡i kho bÃ£i.

### Má»¥c tiÃªu:
- Quáº£n lÃ½ **tÃ i nguyÃªn**: nhÃ¢n sá»±, khÃ¡ch hÃ ng, phÆ°Æ¡ng tiá»‡n, container, sÆ¡ Ä‘á»“ bÃ£i.
- Quáº£n lÃ½ **tÃ¡c nghiá»‡p**: nháº­p/xuáº¥t container, check-in/check-out, Ä‘iá»u Ä‘á»™, nÃ¢ng/háº¡, báº£o trÃ¬.
- Quáº£n lÃ½ **dá»‹ch vá»¥ & tÃ i chÃ­nh**: dá»‹ch vá»¥ phÃ¡t sinh, bÃ¡o giÃ¡, hÃ³a Ä‘Æ¡n, cÃ´ng ná»£, bÃ¡o cÃ¡o.
- Há»— trá»£ **tá»± Ä‘á»™ng hÃ³a quy trÃ¬nh** vÃ  giáº£m thao tÃ¡c thá»§ cÃ´ng.

---

## 2. Quy trÃ¬nh nghiá»‡p vá»¥ container

### 2.1 Quy trÃ¬nh nháº­p container (Import)
1. **Tiáº¿p nháº­n**
   - Container Ä‘áº¿n cá»•ng bÃ£i.
   - Kiá»ƒm tra booking & há»“ sÆ¡ (váº­n Ä‘Æ¡n, háº£i quan).
2. **Kiá»ƒm tra container**
   - Kiá»ƒm tra tÃ¬nh tráº¡ng, seal (niÃªm phong).
3. **Xá»­ lÃ½ hÃ ng hÃ³a**
   - Dá»¡ hÃ ng, kiá»ƒm tra sá»‘ lÆ°á»£ng & cháº¥t lÆ°á»£ng.
   - Thá»§ tá»¥c háº£i quan (náº¿u cáº§n).
4. **LÆ°u kho**
   - Xáº¿p vÃ o vá»‹ trÃ­ kho bÃ£i.
   - Cáº­p nháº­t há»‡ thá»‘ng quáº£n lÃ½.

### 2.2 Quy trÃ¬nh xuáº¥t container (Export)
1. **Chuáº©n bá»‹**
   - Nháº­n yÃªu cáº§u xuáº¥t hÃ ng.
   - Kiá»ƒm tra há»“ sÆ¡ xuáº¥t kháº©u.
2. **Chuáº©n bá»‹ hÃ ng hÃ³a**
   - Thu gom hÃ ng tá»« kho.
   - ÄÃ³ng gÃ³i, xáº¿p container.
3. **HoÃ n thiá»‡n**
   - Kiá»ƒm tra container sau xáº¿p hÃ ng, niÃªm phong.
   - Thá»§ tá»¥c háº£i quan.
   - BÃ n giao cho váº­n chuyá»ƒn.

---

## 3. CÃ¡c phÃ¢n há»‡ chá»©c nÄƒng

### 3.1 Quáº£n lÃ½ danh má»¥c & tÃ i nguyÃªn (Module 1, 9)
- NhÃ¢n sá»±, khÃ¡ch hÃ ng, ngÆ°á»i dÃ¹ng.
- Danh má»¥c dá»‹ch vá»¥ & báº£ng giÃ¡.
- Danh má»¥c váº­t tÆ° báº£o trÃ¬.
- ThÃ´ng tin hÃ£ng tÃ u & hÃ£ng xe.
- Thiáº¿t láº­p sÆ¡ Ä‘á»“ & vá»‹ trÃ­ bÃ£i.

### 3.2 Quáº£n lÃ½ ngÆ°á»i dÃ¹ng & tÃ i khoáº£n (Module 2)
- ÄÄƒng nháº­p, Ä‘á»•i máº­t kháº©u.
- Cáº­p nháº­t thÃ´ng tin cÃ¡ nhÃ¢n.

### 3.3 Quáº£n lÃ½ yÃªu cáº§u dá»‹ch vá»¥ (Module 3)
- KhÃ¡ch hÃ ng táº¡o yÃªu cáº§u nháº­p/xuáº¥t/chuyá»ƒn Ä‘á»•i container.
- Depot tiáº¿p nháº­n & phÃ¢n cÃ´ng cÃ´ng viá»‡c.
- Xuáº¥t phiáº¿u EIR/LOLO & hÃ³a Ä‘Æ¡n.
- Gá»­i yÃªu cáº§u thanh toÃ¡n.
- Káº¿t ná»‘i há»‡ thá»‘ng Reuse container.
- **ğŸ†• Há»‡ thá»‘ng Chat:** Giao tiáº¿p real-time giá»¯a depot staff vÃ  customer vá» Ä‘Æ¡n hÃ ng.

### 3.4 Quáº£n lÃ½ cá»•ng bÃ£i (Module 4)
- Äá»‘i chiáº¿u phiáº¿u háº¹n vá»›i lá»‹ch háº¹n.
- Check-in / Check-out phÆ°Æ¡ng tiá»‡n.
- In phiáº¿u Gate IN/OUT.

### 3.5 Quáº£n lÃ½ Ä‘iá»u Ä‘á»™ & container (Module 5)
- SÆ¡ Ä‘á»“ bÃ£i trá»±c quan, tÃ¬m kiáº¿m container.
- Gá»£i Ã½ vá»‹ trÃ­ nháº­p bÃ£i.
- Quáº£n lÃ½ xe nÃ¢ng & phÃ¢n cÃ´ng cÃ´ng viá»‡c.
- NÃ¢ng/háº¡ container.
- Quáº£n lÃ½ tráº¡ng thÃ¡i container & cáº£nh bÃ¡o DEM/DET.

### 3.6 Quáº£n lÃ½ báº£o trÃ¬ (Module 6)
- Táº¡o & duyá»‡t phiáº¿u sá»­a chá»¯a/kiá»ƒm tra.
- Quáº£n lÃ½ váº­t tÆ° báº£o trÃ¬.
- Cáº­p nháº­t tráº¡ng thÃ¡i container sau sá»­a chá»¯a.
- KhÃ¡ch hÃ ng cháº¥p nháº­n/tá»« chá»‘i sá»­a chá»¯a.

### 3.7 Quáº£n lÃ½ hÃ³a Ä‘Æ¡n & cÃ´ng ná»£ (Module 7)
- Danh sÃ¡ch hÃ³a Ä‘Æ¡n.
- Táº¡o hÃ³a Ä‘Æ¡n tá»« dá»‹ch vá»¥.
- Cáº­p nháº­t thanh toÃ¡n & cÃ´ng ná»£.
- Gá»­i hÃ³a Ä‘Æ¡n qua email.
- BÃ¡o cÃ¡o tÃ i chÃ­nh.

### 3.8 BÃ¡o cÃ¡o & Dashboard (Module 8)
- BÃ¡o cÃ¡o doanh thu, cÃ´ng ná»£.
- BÃ¡o cÃ¡o váº­n hÃ nh: tÃ¬nh tráº¡ng bÃ£i, hiá»‡u suáº¥t cá»•ng, báº£o trÃ¬.
- Dashboard tá»•ng quan KPI.
- Xuáº¥t bÃ¡o cÃ¡o PDF/Excel.
  
  Tham chiáº¿u chi tiáº¿t: xem `backend/docs/MODULE_8_REPORTS.md`.

---

## 4. CÃ¡c Ä‘iá»ƒm kiá»ƒm soÃ¡t quan trá»ng
- **TÃ i liá»‡u**: Booking, háº£i quan, EIR/LOLO, hÃ³a Ä‘Æ¡n.
- **Cháº¥t lÆ°á»£ng**: Container, seal, hÃ ng hÃ³a.

## 5. ğŸ†• **Há»‡ thá»‘ng Chat (Module Chat)**

### **Tá»•ng quan**
Há»‡ thá»‘ng chat má»›i Ä‘Æ°á»£c tÃ­ch há»£p vÃ o TDMS Ä‘á»ƒ há»— trá»£ giao tiáº¿p real-time giá»¯a **Depot Staff** vÃ  **Customer** vá» cÃ¡c Ä‘Æ¡n hÃ ng container.

### **Features chÃ­nh**
- âœ… **Status-based Activation:** Chat chá»‰ hoáº¡t Ä‘á»™ng khi request status â‰¥ SCHEDULED
- âœ… **Real-time Communication:** WebSocket integration cho instant messaging
- âœ… **Message Persistence:** LÆ°u trá»¯ tin nháº¯n vÃ o database
- âœ… **Role-based Access:** Kiá»ƒm tra quyá»n theo user role vÃ  tenant
- âœ… **Container-specific Chat:** Má»—i container cÃ³ chat room riÃªng biá»‡t

### **Tráº¡ng thÃ¡i Ä‘Æ°á»£c phÃ©p chat**
```typescript
const allowedStatuses = [
  'SCHEDULED',        // ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c lÃªn lá»‹ch
  'APPROVED',         // ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c cháº¥p nháº­n
  'IN_PROGRESS',      // ÄÆ¡n hÃ ng Ä‘ang Ä‘Æ°á»£c xá»­ lÃ½
  'COMPLETED',        // ÄÆ¡n hÃ ng Ä‘Ã£ hoÃ n táº¥t
  'EXPORTED'          // ÄÆ¡n hÃ ng Ä‘Ã£ xuáº¥t kho
];
```

### **API Endpoints**
- `POST /chat` - Táº¡o chat room má»›i
- `GET /chat/request/:request_id` - Láº¥y chat room theo request
- `POST /chat/:chat_room_id/messages` - Gá»­i tin nháº¯n
- `GET /chat/:chat_room_id/messages` - Láº¥y danh sÃ¡ch tin nháº¯n
- `GET /chat/user/rooms` - Láº¥y chat rooms cá»§a user

### **TÃ­ch há»£p vá»›i Frontend**
- **DepotChatWindow:** Main chat interface vá»›i API integration
- **DepotChatMini:** Chat trigger vÃ  window management
- **DepotChatDemo:** Demo version cho testing

**Tham chiáº¿u chi tiáº¿t:** Xem `backend/docs/CHAT_SYSTEM.md`
- **An ninh**: Camera, kiá»ƒm soÃ¡t niÃªm phong, giÃ¡m sÃ¡t nÃ¢ng/háº¡.

---

## 5. YÃªu cáº§u ká»¹ thuáº­t chÃ­nh
- **PhÃ¢n quyá»n**: Quáº£n lÃ½ nhÃ¢n sá»±, Sale Admin, Äiá»u Ä‘á»™, Báº£o trÃ¬, Báº£o vá»‡, Káº¿ toÃ¡n, KhÃ¡ch hÃ ng.
- **Real-time update**: Vá»‹ trÃ­ container, tráº¡ng thÃ¡i cÃ´ng viá»‡c, KPI dashboard.
- **TÃ­ch há»£p**: Thanh toÃ¡n online, COS Reuse, mÃ¡y in cá»•ng, email.
- **BÃ¡o cÃ¡o Ä‘á»™ng**: TÃ¹y chá»‰nh theo thá»i gian, loáº¡i dá»‹ch vá»¥, khÃ¡ch hÃ ng.

---

## 6. Káº¿t luáº­n
Há»‡ thá»‘ng TDMS lÃ  giáº£i phÃ¡p tá»•ng thá»ƒ giÃºp sá»‘ hÃ³a toÃ n bá»™ hoáº¡t Ä‘á»™ng depot container, giáº£m giáº¥y tá», tá»‘i Æ°u váº­n hÃ nh, tÄƒng tÃ­nh minh báº¡ch & kháº£ nÄƒng kiá»ƒm soÃ¡t.
